#
# MAZAK VTC20B
#
# YMDS2P YEX3 2xYI32 2xYO32
#
# 2024, http://yurtaev.com
#

[EMC]
MACHINE                 = VTC20
VERSION			= 1.1

[DISPLAY]
DISPLAY			= axis
CYCLE_TIME		= 0.1
HELP_FILE		= doc/help.txt
POSITION_OFFSET		= RELATIVE
POSITION_FEEDBACK	= ACTUAL
MAX_FEED_OVERRIDE	= 2.0
MAX_SPINDLE_OVERRIDE	= 2.0
#MAX_LINEAR_VELOCITY	= 400
MAX_LINEAR_VELOCITY	= 50
DEFAULT_LINEAR_VELOCITY	= 20
DEFAULT_SPINDLE_SPEED	= 100

PROGRAM_PREFIX		= ~/linuxcnc/nc_files
INTRO_GRAPHIC		= linuxcnc.gif
INTRO_TIME		= 1
INCREMENTS		= 1mm, 0.1mm, 0.01mm, 0.001mm
PYVCP			= nyx-6.xml

[APPLICATIONS]
DELAY			= 1
#APP			= nyx-mds-startup.sh

[TASK]
TASK			= milltask
CYCLE_TIME		= 0.01

[RS274NGC]
RS274NGC_STARTUP_CODE	= g21 g64 p0.005 q0.005
PARAMETER_FILE		= vtc20.var
USER_M_PATH		= subs
SUBROUTINE_PATH		= subs
ORIENT_OFFSET		= 0
#REMAP			= M6 modalgroup=6 prolog=change_prolog ngc=m6 epilog=change_epilog
ON_ABORT_COMMAND	= o<on_abort> call
#REMAP			= M10 modalgroup=10 ngc=m10

[EMCMOT]
EMCMOT			= motmod
SERVO_PERIOD		= 888888
COMM_TIMEOUT		= 1.0
COMM_WAIT		= 0.010

[HAL]
HALUI			= halui
HALFILE			= nyx.hal
HALFILE			= vtc20-io.hal
HALFILE			= vtc20.hal
HALFILE			= nyx-mds-sp.hal
HALFILE			= xhc-whb04b-6.hal
POSTGUI_HALFILE		= nyx-6-pgui.hal
#SHUTDOWN		= nyx-mds-shutdown.hal

[NYX]
PARAMS			= vtc20.par
AXES			= 7
VEL_SCALE		= 10
SP_VEL_SCALE		= 10
TRQ_SCALE		= 1

[O]
UMB_CHANGE	= 00
O_AIR_BLAST	= 02

[I]
I_AIR_OK	= 00
S_ORIENTED	= 04
UMB_CHANGED	= 00
I_UMB_1		= 01
I_UMB_2		= 02
I_UMB_LOCKED	= 03
TPFAULT		= 06
I_Z_IND		= 07
I_Z_TOP		= 08

[EMCIO]
EMCIO			= iov2
CYCLE_TIME		= 0.1
TOOL_TABLE		= tools.tbl

[TRAJ]
COORDINATES		= X Y Z
HOME			= 0 0 0
NO_FORCE_HOMING 	= 1
LINEAR_UNITS		= mm
ANGULAR_UNITS		= degree
POSITION_FILE		= vtc20.pos

[KINS]
KINEMATICS		= trivkins
JOINTS			= 3

#			X	Y	Z
# M1 rapid		24000	24000	20000	m/min
#			400	400	333
# M2 home srch		10000	10000	10000	m/min
# N8 home latch		200	200	200	m/min
# M3 feed		5000	5000	5000	m/min
#			83	83	83
# M5 G30		-3.126	-277.24	-188.7	mm
# M8 max limit		1.0	1.0	1.0	mm
# M9 min limit		-1120.0	-510.0	-510.0	mm
# hard stop -		-6	-20	-5
# hard stop +		+8	+5	+20
# M13 0010 0000 	- dir:1:CCW, zrtn:0:+
# M14 1000 0000 	- simplified homing
# M17 0001 0001 	- linear acc/dec
# N1 rapid acc		170	120	90	ms to M3
#			2353	3333	3700	mm/s/s
# N2 cut acc		32	32	32	ms
#			2600	2600	2600	mm/s/s
# N9 grid ignore	0	0	0	um
# N10 grid		10	10	10	mm
# N11 home offs		4.015	9.439	9.830	mm
# N12 rapid backlash	0	0.002	0	mm
# N13 cut backlash	0	0.003	0.0025	mm
# S4 feed-forward gain	40	40	40	%
# S13 G0 in-position	0.2	0.2	0.2	mm
# S14 G1 in-position	0.005	0.005	0.005	mm
# M8 flood coolant
# M50 work air blast
# M51 thru coolant
# M9 coolant OFF
# M10 tool clamp
# M11 tool unclamp
# M12 magazine advance
# M13 magazine retract
# M15 ATC cover close
# M16 ATC cover open
# M35 tool damage detect
# X: 1072+50|12
#    1122 (dog end) 5+4 (z) 7
#    6 1120-4 (dog)

[AXIS_X]
MAX_VELOCITY		= 400
MAX_ACCELERATION	= 2600
MIN_LIMIT		= -1120.000
MAX_LIMIT		=     1.000

[AXIS_Y]
MAX_VELOCITY		= 400
MAX_ACCELERATION	= 2600
MIN_LIMIT		= -510.000
MAX_LIMIT		=    1.000

[AXIS_Z]
MAX_VELOCITY		= 333
MAX_ACCELERATION	= 2600
MIN_LIMIT		= -510.000
MAX_LIMIT		=    1.000

[JOINT_0]
TYPE			= LINEAR
HOME			= -60
MAX_VELOCITY		= 400
MAX_ACCELERATION	= 2600
BACKLASH		= 0.000
SCALE			= -10.0
MIN_LIMIT		= -1120.000
MAX_LIMIT		=     1.000
FERROR			= 20
MIN_FERROR		= 10
HOME_OFFSET		= -60
HOME_SEARCH_VEL		= 10
HOME_LATCH_VEL		= -3
HOME_FINAL_VEL		= 5
HOME_SEQUENCE		= 1
HOME_USE_INDEX		= YES
ABSOLUTE_ENCODER	= 0

[JOINT_1]
TYPE			= LINEAR
HOME			= -60
MAX_VELOCITY		= 400
MAX_ACCELERATION	= 2600
BACKLASH		= 0.003
SCALE			= -10.0
MIN_LIMIT		= -510.000
MAX_LIMIT		=    1.000
FERROR			= 20
MIN_FERROR		= 10
HOME_OFFSET		= -60
HOME_SEARCH_VEL		= 10
HOME_LATCH_VEL		= -3
HOME_FINAL_VEL		= 5
HOME_SEQUENCE		= 1
HOME_USE_INDEX		= YES
ABSOLUTE_ENCODER	= 0

[JOINT_2]
TYPE			= LINEAR
HOME			= -60
MAX_VELOCITY		= 330
MAX_ACCELERATION	= 2600
BACKLASH		= 0.0025
SCALE			= -10.0
MIN_LIMIT		= -510.000
MAX_LIMIT		=    1.000
FERROR			= 20
MIN_FERROR		= 10
HOME_OFFSET		= -60
HOME_SEARCH_VEL		= 10
HOME_LATCH_VEL		= -3
HOME_FINAL_VEL		= 5
HOME_SEQUENCE		= 0
HOME_USE_INDEX		= YES
ABSOLUTE_ENCODER	= 0
